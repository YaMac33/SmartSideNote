<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>記事一覧 - SmartSideNote</title>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MQ9ZB4LYWP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-MQ9ZB4LYWP');
  </script>

  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- 共通ヘッダー -->
  <div id="header-placeholder"></div>
  <script>
    // ページ階層に合わせて header.html のパスを調整
    fetch('header.html') 
      .then(res => res.text())
      .then(data => {
        document.getElementById('header-placeholder').innerHTML = data;
      });
  </script>

  <!-- ページ本文 -->
  <h1>記事一覧</h1>
  <main id="project-list-container">
    <div class="loader"></div>
  </main>

  <script>
    const username = "YaMac33";
    const repoName = "ai-comparison-test-site";

    document.addEventListener("DOMContentLoaded", function () {
      const container = document.getElementById("project-list-container");
      container.innerHTML = '<div class="loader"></div>';

      fetch(`https://api.github.com/repos/${username}/${repoName}/contents/`)
        .then(res => res.json())
        .then(data => {
          container.innerHTML = "";
          data.filter(item => item.type === "dir")
            .sort((a,b) => b.name.localeCompare(a.name))
            .forEach(item => {
              const card = document.createElement("a");
              card.href = `./${item.name}/`;
              card.className = "project-card";
              card.innerHTML = `<h3>${item.name}</h3>`;
              container.appendChild(card);
            });
        })
        .catch(err => {
          container.innerHTML = "<p>データの読み込みに失敗しました。</p>";
          console.error(err);
        });
    });
  </script>

</body>
</html>
