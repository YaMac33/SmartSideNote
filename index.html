<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>記事一覧</title>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MQ9ZB4LYWP"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-MQ9ZB4LYWP');
    </script>

    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- ヘッダー読み込み -->
    <div id="header-placeholder"></div>

    <h1>記事一覧</h1>
    <main id="project-list-container" class="project-list" aria-live="polite">
        <div class="loader"></div>
    </main>

    <script>
        // ヘッダーを先に読み込む
        fetch('_header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-placeholder').innerHTML = data;
            });

        // 記事一覧を取得して表示
        document.addEventListener("DOMContentLoaded", function () {
            var container = document.getElementById("project-list-container");
            container.innerHTML = '<div class="loader"></div>';
            fetch(`https://api.github.com/repos/YaMac33/ai-comparison-test-site/contents/`)
                .then(response => response.json())
                .then(data => {
                    container.innerHTML = "";
                    // ディレクトリのみ抽出して名前順にソート
                    data.filter(item => item.type === "dir")
                        .sort((a, b) => b.name.localeCompare(a.name)) // 降順にしたい場合
                        .forEach(item => {
                            var card = document.createElement("a");
                            card.href = `./${item.name}/`;
                            card.className = "project-card";
                            card.innerHTML = `<h3>${item.name}</h3>`;
                            container.appendChild(card);
                        });
                })
                .catch(error => {
                    container.innerHTML = "<p>データの読み込みに失敗しました。</p>";
                    console.error("Error fetching repository contents:", error);
                });
        });
    </script>
</body>
</html>
